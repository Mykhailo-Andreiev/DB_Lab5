# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ5 ‚Äî –Ü–Ω–¥–µ–∫—Å–∏, –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ —Ç–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤ —É MSSQL

## üéØ –ú–µ—Ç–∞ —Ä–æ–±–æ—Ç–∏
–û–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—è –∑ –ø–æ–Ω—è—Ç—Ç—è–º —ñ–Ω–¥–µ–∫—Å—ñ–≤ —É Microsoft SQL Server, –≤–∏–≤—á–∏—Ç–∏ —ó—Ö –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è, —Ç–∏–ø–∏, —Å–ø–æ—Å–æ–±–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó. –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ä–æ–±–æ—Ç—É –∑ —Å–∏—Å—Ç–µ–º–Ω–∏–º–∏, –≥–ª–æ–±–∞–ª—å–Ω–∏–º–∏ —Ç–∏–º—á–∞—Å–æ–≤–∏–º–∏, –ª–æ–∫–∞–ª—å–Ω–∏–º–∏ —Ç–∏–º—á–∞—Å–æ–≤–∏–º–∏ —Ç–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏–º–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–º–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º–∏, –∑–æ–∫—Ä–µ–º–∞ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π —ñ –≤–∏—Ö—ñ–¥–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤. –¢–∞–∫–æ–∂ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –ø—Ä–æ—Ü–µ–¥—É—Ä—É –º–∞—Å–æ–≤–æ–≥–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–∞ –≤—Å—Ç–∞–≤–∫—É –∑ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è–º ID.

## üìÇ –§–∞–π–ª–∏ —É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó
- `QUERY.sql` ‚Äî —É—Å—ñ SQL-—Å–∫—Ä–∏–ø—Ç–∏ –∑ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏
- `README_Lab5_FULL.md` ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –¥–æ –≤–∏–∫–æ–Ω–∞–Ω–æ—ó —Ä–æ–±–æ—Ç–∏

## ‚öôÔ∏è –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ —Ç–∏–ø–∏ —ñ–Ω–¥–µ–∫—Å—ñ–≤
1. **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–∏–π —ñ–Ω–¥–µ–∫—Å** ‚Äî –ø–µ—Ä–≤–∏–Ω–Ω–∏–π –∫–ª—é—á `EmployeeID` —É —Ç–∞–±–ª–∏—Ü—ñ `Employee`
2. **–ù–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–∏–π —ñ–Ω–¥–µ–∫—Å** ‚Äî `AllowanceName` —É —Ç–∞–±–ª–∏—Ü—ñ `Allowance`
3. **–£–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–Ω–¥–µ–∫—Å** ‚Äî `PhoneNumber` —É —Ç–∞–±–ª–∏—Ü—ñ `Employee`
4. **–Ü–Ω–¥–µ–∫—Å –∑ –≤–∫–ª—é—á–µ–Ω–∏–º–∏ —Å—Ç–æ–≤–ø—Ü—è–º–∏** ‚Äî `AllowanceName INCLUDE(Description)` —É `Allowance`
5. **–§—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏–π —ñ–Ω–¥–µ–∫—Å** ‚Äî `EmployeeID=1` –∑ –≤–∫–ª—é—á–µ–Ω–∏–º–∏ `ErrorType, ErrorDetails` —É `ErrorReport`

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∞–Ω–∞–ª—ñ–∑—É —ñ–Ω–¥–µ–∫—Å—ñ–≤

–ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –ø—Ä–∏–∫–ª–∞–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –∑–∞–ø–∏—Ç—É, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –æ—Ü—ñ–Ω–∏—Ç–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü—ñ—é —ñ–Ω–¥–µ–∫—Å—ñ–≤ —É —Ç–∞–±–ª–∏—Ü—è—Ö –±–∞–∑–∏ –¥–∞–Ω–∏—Ö: –∑–Ω–∞—á–µ–Ω–Ω—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü—ñ—ó –ø–æ–∫–∞–∑—É—é—Ç—å —Ä—ñ–∑–Ω–∏—Ü—é —É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –º—ñ–∂ –∑–∞–ø–∏—Ç–∞–º–∏ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —ñ–Ω–¥–µ–∫—Å—ñ–≤ —Ç–∞ –±–µ–∑ –Ω–∏—Ö, —â–æ –¥–æ–∑–≤–æ–ª—è—î –≤—ñ–∑—É–∞–ª—å–Ω–æ –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å.

![–ê–Ω–∞–ª—ñ–∑ —ñ–Ω–¥–µ–∫—Å—ñ–≤](images/table.png)


## üìã –°–∏—Å—Ç–µ–º–Ω—ñ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏
- `sp_helpindex 'Employee'` ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —ñ–Ω–¥–µ–∫—Å—ñ–≤
- `sp_spaceused 'Employee'` ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º º—è—Ç—ñ
- `sp_columns 'Employee'` ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ñ

## üîí –ì–ª–æ–±–∞–ª—å–Ω—ñ —Ç–∏–º—á–∞—Å–æ–≤—ñ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏
- `##GetEmployeePaymentsByPeriod(@EmployeeID, @StartPeriod, @EndPeriod)` ‚Äî –≤–∏–ø–ª–∞—Ç–∏ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—É –∑–∞ –ø–µ—Ä—ñ–æ–¥
- `##GetPositionAllowances(@PositionID)` ‚Äî –Ω–∞–¥–±–∞–≤–∫–∏ –¥–æ –ø–æ—Å–∞–¥–∏
- `##GetRecentErrors(@DaysBack)` ‚Äî –ø–æ–º–∏–ª–∫–∏ –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ N –¥–Ω—ñ–≤

## üìå –õ–æ–∫–∞–ª—å–Ω—ñ —Ç–∏–º—á–∞—Å–æ–≤—ñ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏
- `#GetAveragePaymentPerEmployee` ‚Äî —Å–µ—Ä–µ–¥–Ω—è –≤–∏–ø–ª–∞—Ç–∞ –Ω–∞ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞
- `#GetEmployeePositionAndSalary` ‚Äî —Å–ø–∏—Å–æ–∫ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ —ñ –ø–æ—Å–∞–¥
- `#GetAllAllowancesByPosition` ‚Äî –ø–æ–≤–Ω–∏–π —Å–ø–∏—Å–æ–∫ –Ω–∞–¥–±–∞–≤–æ–∫ –¥–æ –ø–æ—Å–∞–¥

## üß© –ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ (–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è–º–∏)
- `InsertPaymentWithCheck(@EmployeeID, @Period, @PaymentAmount)` ‚Äî –≤—Å—Ç–∞–≤–∫–∞ –≤–∏–ø–ª–∞—Ç–∏ –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é
- `UpdateSalaryAndLog(@PositionID, @NewSalary)` ‚Äî –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –±–∞–∑–æ–≤–æ–≥–æ –æ–∫–ª–∞–¥—É
- `TransferEmployee(@EmployeeID, @NewPositionID)` ‚Äî –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—è –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞

## ‚ûï –î–æ–¥–∞—Ç–∫–æ–≤—ñ –ø—Ä–æ—Ü–µ–¥—É—Ä–∏
- `AddEmployeesInBulk(@RowCount)` ‚Äî –º–∞—Å–æ–≤–µ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫—ñ–≤ —É `Employee`
- `InsertPositionAndReturnID(@PositionName, @BaseSalary, @NewPositionID OUTPUT)` ‚Äî –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ø–æ—Å–∞–¥–∏ –∑ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è–º ID

## ‚úÖ –í–∏—Å–Ω–æ–≤–∫–∏
–ü—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ —è —Ä–µ–∞–ª—ñ–∑—É–≤–∞–≤ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –∞–Ω–∞–ª—ñ–∑ –ø º—è—Ç–∏ —Ç–∏–ø—ñ–≤ —ñ–Ω–¥–µ–∫—Å—ñ–≤, –æ—Ü—ñ–Ω–∏–≤ —ó—Ö–Ω—é –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø—Ä–∏ —Ä—ñ–∑–Ω—ñ–π –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Ä—è–¥–∫—ñ–≤ —É —Ç–∞–±–ª–∏—Ü—è—Ö, –∞ —Ç–∞–∫–æ–∂ —Ä–µ–∞–ª—ñ–∑—É–≤–∞–≤ —Ä—ñ–∑–Ω—ñ —Ç–∏–ø–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä, –≤–∫–ª—é—á–Ω–æ –∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è–º–∏ —Ç–∞ –≤–∏—Ö—ñ–¥–Ω–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. –û—Ç—Ä–∏–º–∞–Ω—ñ –∑–Ω–∞–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—é—Ç—å –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, –ø—ñ–¥–≤–∏—â–∏—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤ —ñ –∫—Ä–∞—â–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –ª–æ–≥—ñ–∫—É –±—ñ–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—ñ–≤ —É SQL Server.